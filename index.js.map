{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '48823979-822a726f00604f1f8a353c21f';\n\n\nexport async function fetchImages(query, page) {\n    const params = {\n        key: API_KEY,\n        q: query, \n        image_type: \"photo\", \n        orientation: \"horizontal\",\n        safesearch: true,\n        mode: 'cors',\n        per_page: 40,\n        page: page,\n    };\n\n    try {\n        const response = await axios.get(BASE_URL, { params });\n        const images = response.data.hits;\n        const totalHits = response.data.totalHits;\n        return { images, totalHits };\n    } catch (error) {\n        iziToast.error({ message: 'Sorry. Please try again!' });\n        console.error(\"Fetch error:\", error);\n        return { images: [], totalHits: 0 };\n    } \n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector(\".gallery\");\nexport function renderImages(images) {\n    const markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => \n        `<a href=\"${largeImageURL}\" class=\"gallery-item\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-image\" />\n            <div class=\"info\">\n                <p><strong>Likes:</strong> ${likes}</p>\n                <p><strong>Views:</strong> ${views}</p>\n                <p><strong>Comments:</strong> ${comments}</p>\n                <p><strong>Downloads:</strong> ${downloads}</p>\n            </div> \n        </a>`\n    ).join(\"\");\n\n    gallery.insertAdjacentHTML('beforeend', markup);\n    const lightbox = new SimpleLightbox(\".gallery a\", {\n        captionsData: \"alt\",\n        captionDelay: 250,\n    });\n    lightbox.refresh();\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { fetchImages } from \"./js/pixabay-api\";\nimport { renderImages } from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst form = document.querySelector(\"#form\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".load-more\");\nconst gallery = document.querySelector(\".gallery\");\nlet query = \"\";\nlet page = 1;\nlet per_page = 40;\nlet totalHits = 0;\n\nfunction showBtnLoadMore() {\n    btnLoadMore.classList.remove('hidden');\n}\n\nfunction hiddenBtnLoadMore() {\n    btnLoadMore.classList.add('hidden');\n}\n\nfunction showEndMessage() {\n    iziToast.info({ position: 'bottomCenter', message: \"Sorry, you've reached the end of search results.\", color: 'red' });\n}\nfunction showLoader(afterElement){\n    loader.style.display = \"block\"; \n    afterElement.insertAdjacentElement(\"afterend\", loader);\n}\nfunction hiddenLoader(){\n    loader.style.display = \"none\"; \n}\n\nfunction scrollToNewGallery() {\n   const galleryItem = document.querySelector(\".gallery-item:last-child\");\n  if (galleryItem) {\n       const rect = galleryItem.getBoundingClientRect();\n      const itemHeight = rect.height;\n      window.scrollBy({ top:  itemHeight * 2, behavior: 'smooth',});\n    };}\n    function checkPage(){\n        const totalPage = Math.ceil(totalHits / per_page);\n        if(page >= totalPage){\n            hiddenBtnLoadMore();\n            showEndMessage();\n        }else{\n            showBtnLoadMore();\n        }\n    };\n\n    form.addEventListener(\"submit\", async (event) => {\n        event.preventDefault();\n        query = event.target.elements.text.value.trim();\n        page = 1;\n        gallery.innerHTML = \"\"; \n       \n        \n        if (!query ||  /^\\d+$/.test(query.trim())) {\n            iziToast.error({ message: \"Please enter a search query!\",\n                position: \"topRight\",\n                color: 'yellow',\n             });\n            return;\n        }\n          hiddenBtnLoadMore();\n          showLoader(form);\n        try {\n            const { images, totalHits: newTotalHits } = await fetchImages(query, page);\n            totalHits = newTotalHits;\n            if(images.length === 0){\n                iziToast.error({\n                    message: \"No images found\", position: \"topRight\", color: \"red\"\n                });\n                return;\n            }\n            renderImages(images);\n            checkPage();\n        } catch (error) {\n            iziToast.error({ message: \"There was an error fetching the images.\", position: \"topRight\", color: \"red\" });\n            hiddenBtnLoadMore();\n        } finally {\n            hiddenLoader();\n            form.reset();\n        }\n    });\n\nbtnLoadMore.addEventListener('click', async () => {\n    page += 1; \n    showLoader(btnLoadMore);\n    try {\n        const { images } = await fetchImages(query, page);\n        if (images.length === 0) {\n            hiddenBtnLoadMore();\n            return;\n        }\n        renderImages(images);\n        scrollToNewGallery();\n        checkPage();  \n    } catch (error) {\n        iziToast.error({\n            message: \"Error loading more images.\", position: \"topRight\", color: \"red\",\n        });\n        hiddenBtnLoadMore();\n    } finally {\n        hiddenLoader();\n    }\n});\n\n \n"],"names":["BASE_URL","API_KEY","fetchImages","query","page","params","response","axios","images","totalHits","error","iziToast","gallery","renderImages","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","form","loader","btnLoadMore","per_page","showBtnLoadMore","hiddenBtnLoadMore","showEndMessage","showLoader","afterElement","hiddenLoader","scrollToNewGallery","galleryItem","itemHeight","checkPage","totalPage","event","newTotalHits"],"mappings":"owBAMA,MAAMA,EAAW,2BACXC,EAAU,qCAGT,eAAeC,EAAYC,EAAOC,EAAM,CAC3C,MAAMC,EAAS,CACX,IAAKJ,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAM,OACN,SAAU,GACV,KAAMC,CACT,EAED,GAAI,CACA,MAAME,EAAW,MAAMC,EAAM,IAAIP,EAAU,CAAE,OAAAK,EAAQ,EAC/CG,EAASF,EAAS,KAAK,KACvBG,EAAYH,EAAS,KAAK,UAChC,MAAO,CAAE,OAAAE,EAAQ,UAAAC,CAAW,CAC/B,OAAQC,EAAO,CACZ,OAAAC,EAAS,MAAM,CAAE,QAAS,0BAA0B,CAAE,EACtD,QAAQ,MAAM,eAAgBD,CAAK,EAC5B,CAAE,OAAQ,GAAI,UAAW,CAAG,CACtC,CACL,CC7BA,MAAME,EAAU,SAAS,cAAc,UAAU,EAC1C,SAASC,EAAaL,EAAQ,CACjC,MAAMM,EAASN,EAAO,IAAI,CAAC,CAAE,aAAAO,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAC/F,YAAYL,CAAa;AAAA,wBACTD,CAAY,UAAUE,CAAI;AAAA;AAAA,6CAELC,CAAK;AAAA,6CACLC,CAAK;AAAA,gDACFC,CAAQ;AAAA,iDACPC,CAAS;AAAA;AAAA,aAG1D,EAAM,KAAK,EAAE,EAETT,EAAQ,mBAAmB,YAAaE,CAAM,EAC7B,IAAIQ,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,GACtB,CAAK,EACQ,QAAS,CACtB,CCfA,MAAMC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EACjDb,EAAU,SAAS,cAAc,UAAU,EACjD,IAAIT,EAAQ,GACRC,EAAO,EACPsB,EAAW,GACXjB,EAAY,EAEhB,SAASkB,GAAkB,CACvBF,EAAY,UAAU,OAAO,QAAQ,CACzC,CAEA,SAASG,GAAoB,CACzBH,EAAY,UAAU,IAAI,QAAQ,CACtC,CAEA,SAASI,GAAiB,CACtBlB,EAAS,KAAK,CAAE,SAAU,eAAgB,QAAS,mDAAoD,MAAO,MAAO,CACzH,CACA,SAASmB,EAAWC,EAAa,CAC7BP,EAAO,MAAM,QAAU,QACvBO,EAAa,sBAAsB,WAAYP,CAAM,CACzD,CACA,SAASQ,GAAc,CACnBR,EAAO,MAAM,QAAU,MAC3B,CAEA,SAASS,GAAqB,CAC3B,MAAMC,EAAc,SAAS,cAAc,0BAA0B,EACtE,GAAIA,EAAa,CAEb,MAAMC,EADQD,EAAY,sBAAuB,EACzB,OACxB,OAAO,SAAS,CAAE,IAAMC,EAAa,EAAG,SAAU,SAAU,CAC5D,CAAA,CACF,SAASC,GAAW,CAChB,MAAMC,EAAY,KAAK,KAAK5B,EAAYiB,CAAQ,EAC7CtB,GAAQiC,GACPT,EAAmB,EACnBC,EAAgB,GAEhBF,EAAiB,CAE7B,CAEIJ,EAAK,iBAAiB,SAAU,MAAOe,GAAU,CAO7C,GANAA,EAAM,eAAgB,EACtBnC,EAAQmC,EAAM,OAAO,SAAS,KAAK,MAAM,KAAM,EAC/ClC,EAAO,EACPQ,EAAQ,UAAY,GAGhB,CAACT,GAAU,QAAQ,KAAKA,EAAM,KAAI,CAAE,EAAG,CACvCQ,EAAS,MAAM,CAAE,QAAS,+BACtB,SAAU,WACV,MAAO,QACvB,CAAc,EACF,MACZ,CACUiB,EAAmB,EACnBE,EAAWP,CAAI,EACjB,GAAI,CACA,KAAM,CAAE,OAAAf,EAAQ,UAAW+B,CAAc,EAAG,MAAMrC,EAAYC,EAAOC,CAAI,EAEzE,GADAK,EAAY8B,EACT/B,EAAO,SAAW,EAAE,CACnBG,EAAS,MAAM,CACX,QAAS,kBAAmB,SAAU,WAAY,MAAO,KAC7E,CAAiB,EACD,MAChB,CACYE,EAAaL,CAAM,EACnB4B,EAAW,CACd,MAAe,CACZzB,EAAS,MAAM,CAAE,QAAS,0CAA2C,SAAU,WAAY,MAAO,MAAO,EACzGiB,EAAmB,CAC/B,QAAkB,CACNI,EAAc,EACdT,EAAK,MAAO,CACxB,CACA,CAAK,EAELE,EAAY,iBAAiB,QAAS,SAAY,CAC9CrB,GAAQ,EACR0B,EAAWL,CAAW,EACtB,GAAI,CACA,KAAM,CAAE,OAAAjB,CAAQ,EAAG,MAAMN,EAAYC,EAAOC,CAAI,EAChD,GAAII,EAAO,SAAW,EAAG,CACrBoB,EAAmB,EACnB,MACZ,CACQf,EAAaL,CAAM,EACnByB,EAAoB,EACpBG,GACH,MAAe,CACZzB,EAAS,MAAM,CACX,QAAS,6BAA8B,SAAU,WAAY,MAAO,KAChF,CAAS,EACDiB,EAAmB,CAC3B,QAAc,CACNI,EAAc,CACtB,CACA,CAAC"}